<template>
    <div class="notes-tab-container" onkeydown={handleKeyDown}>
        
        <!-- Header -->
        <div class="slds-page-header slds-page-header_record-home">
            <div class="slds-page-header__row">
                <div class="slds-page-header__col-title">
                    <div class="slds-media">
                        <div class="slds-media__figure">
                            <lightning-icon icon-name="standard:note" size="medium"></lightning-icon>
                        </div>
                        <div class="slds-media__body">
                            <div class="slds-page-header__name">
                                <div class="slds-page-header__name-title">
                                    <h1>
                                        <span class="slds-page-header__title slds-truncate">Case Notes</span>
                                    </h1>
                                </div>
                            </div>
                            <p class="slds-page-header__name-meta">Internal and EOB notes for case adjudication</p>
                        </div>
                    </div>
                </div>
                <div class="slds-page-header__col-actions">
                    <div class="slds-page-header__controls">
                        <div class="slds-page-header__control">
                            <lightning-button-group>
                                <lightning-button 
                                    variant="neutral" 
                                    label="Cancel" 
                                    onclick={handleCancel}
                                    disabled={isDisabled}
                                    class="cancel-button">
                                </lightning-button>
                                <lightning-button 
                                    variant="brand" 
                                    label={saveButtonLabel}
                                    onclick={handleSave}
                                    disabled={isDisabled}
                                    class="save-button">
                                </lightning-button>
                            </lightning-button-group>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Unsaved Changes Indicator -->
        <template if:true={hasUnsavedChanges}>
            <div class="slds-notify slds-notify_alert slds-alert_warning" role="alert">
                <span class="slds-assistive-text">Warning</span>
                <lightning-icon icon-name="utility:warning" size="x-small" class="slds-m-right_x-small"></lightning-icon>
                <h2>You have unsaved changes. Press Ctrl+S to save or click Cancel to discard.</h2>
            </div>
        </template>

        <!-- Notes Form -->
        <div class="slds-card">
            <div class="slds-card__body slds-card__body_inner">
                <div class="slds-grid slds-wrap slds-gutters">
                    
                    <!-- Internal Note -->
                    <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label" for="internal-note">
                                <abbr class="slds-required" title="required">*</abbr>
                                Internal Note
                            </label>
                            <div class="slds-form-element__control">
                                <lightning-textarea
                                    id="internal-note"
                                    name="internalNote"
                                    value={internalNote}
                                    onchange={handleInternalNoteChange}
                                    placeholder="Enter internal notes for billing team use only..."
                                    max-length={maxLength}
                                    disabled={isDisabled}
                                    class="internal-note-field">
                                </lightning-textarea>
                                <div class={internalNoteCharCountClass}>
                                    {internalNoteCharCount} / {maxLength} characters
                                </div>
                            </div>
                            <div class="slds-form-element__help">
                                Internal notes are visible only to billing team members and are not shared with external parties.
                            </div>
                        </div>
                    </div>

                    <!-- EOB Note -->
                    <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                        <div class="slds-form-element">
                            <label class="slds-form-element__label" for="eob-note">
                                EOB Note
                            </label>
                            <div class="slds-form-element__control">
                                <lightning-textarea
                                    id="eob-note"
                                    name="eobNote"
                                    value={eobNote}
                                    onchange={handleEobNoteChange}
                                    placeholder="Enter EOB-specific notes for case processing..."
                                    max-length={maxLength}
                                    disabled={isDisabled}
                                    class="eob-note-field">
                                </lightning-textarea>
                                <div class={eobNoteCharCountClass}>
                                    {eobNoteCharCount} / {maxLength} characters
                                </div>
                            </div>
                            <div class="slds-form-element__help">
                                EOB notes are used for Explanation of Benefits processing and case documentation.
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Keyboard Shortcuts Help -->
        <div class="slds-card slds-m-top_medium">
            <div class="slds-card__header">
                <h2 class="slds-card__header-title">
                    <span class="slds-text-heading_small">Keyboard Shortcuts</span>
                </h2>
            </div>
            <div class="slds-card__body slds-card__body_inner">
                <div class="slds-text-body_small">
                    <strong>Ctrl + S:</strong> Save notes
                </div>
            </div>
        </div>

    </div>
</template>